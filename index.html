<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Team Directory</title>
<style>
  body { font-family: system-ui, sans-serif; max-width: 800px; margin: 2rem auto; padding: 0 1rem; color: #333; }
  h1 { margin-bottom: 1.5rem; }
  table { width: 100%; border-collapse: collapse; }
  th, td { text-align: left; padding: 0.75rem 1rem; border-bottom: 1px solid #e0e0e0; }
  th { font-weight: 600; border-bottom: 2px solid #333; }
  a { color: #0366d6; text-decoration: none; }
  a:hover { text-decoration: underline; }
  .error { color: #c00; }
</style>
</head>
<body>
<h1>Team Directory</h1>
<div id="content"></div>
<script>
fetch('data.json')
  .then(r => r.json())
  .then(data => {
    // Find the first table in the JSON (json-git stores {TableName: [rows...]})
    const tables = Object.entries(data);
    if (tables.length === 0) {
      document.getElementById('content').innerHTML = '<p>No data.</p>';
      return;
    }
    for (const [name, rows] of tables) {
      if (rows.length === 0) continue;
      const cols = Object.keys(rows[0]).filter(k => k !== 'id');
      let html = `<h2>${name}</h2><table><thead><tr>`;
      for (const col of cols) html += `<th>${col}</th>`;
      html += '</tr></thead><tbody>';
      for (const row of rows) {
        html += '<tr>';
        for (const col of cols) {
          const val = row[col] ?? '';
          if (typeof val === 'string' && val.includes('@'))
            html += `<td><a href="mailto:${val}">${val}</a></td>`;
          else
            html += `<td>${val}</td>`;
        }
        html += '</tr>';
      }
      html += '</tbody></table>';
      document.getElementById('content').innerHTML += html;
    }
  })
  .catch(() => {
    document.getElementById('content').innerHTML = '<p class="error">Could not load data.json</p>';
  });
</script>
</body>
</html>
